<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Online Video Call</title>
<style>
body { font-family: Arial; text-align: center; background: #f0f0f0; }
#videos { display: flex; flex-wrap: wrap; justify-content: center; margin-top: 20px; }
video { width: 300px; margin: 10px; border-radius: 8px; border: 2px solid #333; }
input, button { padding: 8px 12px; margin: 5px; font-size: 16px; }
</style>
</head>
<body>
<h2>Free Online Video Call</h2>

<input type="text" id="peer-id-input" placeholder="Enter Peer ID to call">
<button id="call-btn">Call</button>
<p>Your Peer ID will appear here:</p>
<p id="my-id"></p>

<div id="videos">
  <video id="my-video" autoplay muted></video>
  <video id="remote-video" autoplay></video>
</div>

<!-- PeerJS CDN -->
<script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
<script>
const myVideo = document.getElementById('my-video');
const remoteVideo = document.getElementById('remote-video');
const callBtn = document.getElementById('call-btn');
const peerInput = document.getElementById('peer-id-input');
const myIdDisplay = document.getElementById('my-id');

let myStream;

// 1️⃣ Get camera & mic
navigator.mediaDevices.getUserMedia({ video: true, audio: true })
.then(stream => {
  myStream = stream;
  myVideo.srcObject = stream;
})
.catch(err => alert("Error accessing camera/mic: " + err));

// 2️⃣ Create PeerJS connection (free cloud server)
const peer = new Peer(); // auto-generated ID

peer.on('open', id => {
  myIdDisplay.innerText = id;
  console.log("Your Peer ID:", id);
  alert("Your Peer ID: " + id);
});

// 3️⃣ Receive calls
peer.on('call', call => {
  call.answer(myStream); // answer with your stream
  call.on('stream', remoteStream => {
    remoteVideo.srcObject = remoteStream;
  });
});

// 4️⃣ Make a call
callBtn.addEventListener('click', () => {
  const remotePeerId = peerInput.value.trim();
  if (!remotePeerId) return alert("Enter a Peer ID to call");
  const call = peer.call(remotePeerId, myStream);
  call.on('stream', remoteStream => {
    remoteVideo.srcObject = remoteStream;
  });
});
</script>
</body>
</html>
